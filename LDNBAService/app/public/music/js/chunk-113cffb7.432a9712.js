(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-113cffb7"],{"09a4":function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comments"},[s("div",{staticClass:"comment_hd"},[s("h2",[t._v("评论"),s("em",[t._v("共"+t._s(t.total)+"条评论")])]),t.userInfo?s("div",{staticClass:"userInfo"},[s("span",[t._v(t._s(t.userInfo.nickname))]),s("el-image",{staticClass:"avatar",attrs:{src:t.userInfo.avatarUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1):t._e()]),s("el-form",{staticClass:"comment_box"},[s("div",{staticClass:"comment_textarea"},[s("div",{staticClass:"pre"},[t._v(t._s(t.msg))]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],staticClass:"J_inpBox inp-paragraph",attrs:{name:"leave_msg",id:"leave_msg",placeholder:"期待你的神评论……"},domProps:{value:t.msg},on:{input:function(e){e.target.composing||(t.msg=e.target.value)}}})]),s("div",{staticClass:"comment_box_footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.subComment}},[t._v("评论")]),s("span",{staticClass:"comment_limit"},[s("em",{staticClass:"num"},[t._v(t._s(t.msg.length))]),t._v("/"+t._s(t.maxLen))])],1)]),s("div",{staticClass:"comment_area"},[t.comments.length?[t._l(t.comments,(function(e,n){return s("div",{key:e.commentId+n+"",staticClass:"comment_item"},[s("router-link",{staticClass:"comment_avatar",attrs:{to:{path:"/user",query:{id:e.user.userId}}}},[s("el-image",{attrs:{src:e.user.avatarUrl+"?param=120y120"}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1),s("div",{staticClass:"comment_info"},[s("router-link",{attrs:{to:{path:"/user",query:{id:e.user.userId}}}},[t._v(t._s(e.user.nickname))]),s("div",{staticClass:"comment_content"},[t._v(" "+t._s(e.content)+" ")]),t._l(e.beReplied,(function(e){return s("div",{key:e.beRepliedCommentId,staticClass:"comment_reply"},[s("router-link",{attrs:{to:{path:"/user",query:{id:e.user.userId}}}},[t._v(t._s(e.user.nickname))]),t._v(": "+t._s(e.content)+" ")],1)})),s("div",{staticClass:"comment_footer"},[s("div",{staticClass:"comment_time"},[t._v(t._s(t.$utils.formatMsgTime(e.time)))]),s("div",{staticClass:"comment_oper"},[t.userInfo&&t.userInfo.userId===e.user.userId?s("em",{staticClass:"comment_del",on:{click:function(s){return t.delComment(e)}}},[s("i",{staticClass:"iconfont icon-del"})]):t._e(),s("span",{class:[e.liked?"active":""],on:{click:function(s){return t.likeComment(e)}}},[s("i",{staticClass:"iconfont icon-praise"}),t._v("("+t._s(e.likedCount)+")")]),s("span",{staticClass:"replyComment",on:{click:function(s){return t.replyComment(e,n)}}},[s("i",{staticClass:"iconfont icon-comment"})])])]),e.isHot?s("div",{staticClass:"isHot"},[s("i",{staticClass:"iconfont icon-choicest"})]):t._e(),s("transition",{attrs:{name:"fade",mode:"out-in"}},[t.isShowReply(e,n)?s("replyComment",{attrs:{params:e},on:{replyMsg:t.replyMsg}}):t._e()],1)],2)],1)})),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:this.total},on:{"current-change":t.currentChange}})],1)]:s("div",{staticClass:"comments_status"},[t.isEmpty?s("div",{staticClass:"empty"},[t._m(0),s("p",[t._v("暂无留言")])]):s("div",{staticClass:"loading"},[t._v("评论加载中...")])])],2)],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("i",{staticClass:"iconfont icon-empty-main"})])}],i=s("2909"),r=s("1da1"),o=s("5530"),c=(s("96cf"),s("a9e3"),s("d81d"),s("99af"),s("2f62")),m=s("93a3"),l={name:"Comments",components:{replyComment:m["a"]},props:{type:{type:Number,default:0},id:{type:String,default:"0"}},data:function(){return{msg:"",maxLen:140,curId:this.id,limit:20,offset:0,before:0,hotComments:[],comments:[],total:0,currentPage:0,isEmpty:!1,replyCommentId:0,replyIndex:-1}},computed:Object(o["a"])(Object(o["a"])({},Object(c["c"])(["isLogin","userInfo"])),{},{isShowReply:function(){return function(t,e){return t.commentId===this.replyCommentId&&this.replyIndex===e}}}),mounted:function(){this.getComment()},methods:Object(o["a"])(Object(o["a"])({},Object(c["d"])(["setLoginDialog"])),{},{getComment:function(){switch(this.type){case 0:this.getSongComment();break;case 1:this.getMvComment();break;case 3:this.getAlbumComment();break;case 5:this.getVideoComment();break}},getSongComment:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.commentSong({id:t.curId,limit:t.limit,offset:t.offset,before:t.before});case 2:s=e.sent,n=s.data,t.msgHandler(n);case 5:case"end":return e.stop()}}),e)})))()},getMvComment:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.commentMv({id:t.curId,limit:t.limit,offset:t.offset,before:t.before});case 2:s=e.sent,n=s.data,t.msgHandler(n);case 5:case"end":return e.stop()}}),e)})))()},getAlbumComment:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.albumComment({id:t.curId,limit:t.limit,offset:t.offset,before:t.before});case 2:s=e.sent,n=s.data,t.msgHandler(n);case 5:case"end":return e.stop()}}),e)})))()},getVideoComment:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.commentVideo({id:t.curId,limit:t.limit,offset:t.offset,before:t.before});case 2:s=e.sent,n=s.data,t.msgHandler(n);case 5:case"end":return e.stop()}}),e)})))()},msgHandler:function(t){if(200!==t.code)return this.$msg.error("数据请求失败");this.total=t.total,this.hotComments=t.hotComments||[],this.hotComments.map((function(t){return t.isHot=!0,t})),this.comments=[].concat(Object(i["a"])(this.hotComments),Object(i["a"])(t.comments)),this.isEmpty=0===this.before&&!this.comments.length},commentHandler:function(t,e,s){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={t:t,type:n.type,id:n.curId,content:e,commentId:s},a.next=3,n.$http.comment(i);case 3:if(r=a.sent,o=r.data,200===o.code){a.next=7;break}return a.abrupt("return",n.$msg.error("数据请求失败"));case 7:n.msg="",n.getComment(),0===t?n.$msg.success("删除评论成功！"):1===t?n.$msg.success("评论成功！"):2===t&&(n.$msg.success("回复评论成功！"),n.replyCommentId=0,n.replyIndex=-1);case 10:case"end":return a.stop()}}),a)})))()},subComment:function(){this.isLogin?this.commentHandler(1,this.msg):this.setLoginDialog(!0)},delComment:function(t){var e=this;this.$msgBox.confirm("确定删除评论？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){e.commentHandler(0,"",t.commentId)})).catch((function(){}))},replyComment:function(t,e){this.isLogin?(this.replyCommentId=this.replyCommentId===t.commentId&&this.replyIndex===e?0:t.commentId,this.replyIndex=e):this.setLoginDialog(!0)},replyMsg:function(t){this.isLogin?this.commentHandler(2,t,this.replyCommentId):this.setLoginDialog(!0)},likeComment:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var n,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(e.isLogin){s.next=3;break}return e.setLoginDialog(!0),s.abrupt("return");case 3:return s.next=5,e.$http.commentLike({id:e.curId,cid:t.commentId,t:Number(!t.liked),type:e.type});case 5:if(n=s.sent,a=n.data,200===a.code){s.next=9;break}return s.abrupt("return",e.$msg.error("数据请求失败"));case 9:e.getComment();case 10:case"end":return s.stop()}}),s)})))()},currentChange:function(t){this.offset=(t-1)*this.limit,this.getComment()}}),watch:{id:function(t,e){this.curId=t,this.offset=0,this.getComment()},msg:function(){this.msg=this.maxLen>=this.msg?this.msg:this.msg.substring(0,this.maxLen)}}},u=l,d=(s("988f"),s("2877")),p=Object(d["a"])(u,n,a,!1,null,"bf18895a",null);e["a"]=p.exports},"2a91":function(t,e,s){},"37c1":function(t,e,s){"use strict";s("2a91")},6819:function(t,e,s){"use strict";s("a679")},"84bc":function(t,e,s){},"93a3":function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"reply-comment"},[s("h3",[t._v("我回复@"+t._s(t.params.user.nickname)+":")]),s("div",{staticClass:"comment_textarea"},[s("div",{staticClass:"pre"},[t._v(t._s(t.msg))]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],staticClass:"J_inpBox inp-paragraph",attrs:{name:"leave_msg",id:"leave_msg",placeholder:"期待你的神评论……"},domProps:{value:t.msg},on:{input:function(e){e.target.composing||(t.msg=e.target.value)}}})]),s("div",{staticClass:"comment_box_footer"},[s("span",{staticClass:"comment_limit"},[s("em",{staticClass:"num"},[t._v(t._s(t.msg.length))]),t._v("/"+t._s(t.maxLen))]),s("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.subReplyComment}},[t._v("评论")])],1)])},a=[],i={name:"replyComment",components:{},props:["params"],data:function(){return{msg:"",maxLen:140}},computed:{},methods:{subReplyComment:function(){this.$emit("replyMsg",this.msg)}},watch:{msg:function(){this.msg=this.maxLen>=this.msg?this.msg:this.msg.substring(0,this.maxLen)}}},r=i,o=(s("6819"),s("2877")),c=Object(o["a"])(r,n,a,!1,null,"6a6b203a",null);e["a"]=c.exports},"988f":function(t,e,s){"use strict";s("84bc")},a679:function(t,e,s){},dbea:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.details?s("div",{staticClass:"album"},[s("div",[s("div",{staticClass:"album-cover"},[s("div",{staticClass:"album-img"},[s("el-image",{attrs:{src:t.details.picUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1),s("div",{staticClass:"album-info"},[s("div",{staticClass:"album-title"},[t._v(" "+t._s(t.details.name)+" "),s("span",[t._v(t._s("#"+t.details.type))])]),s("div",{staticClass:"album-singer"},[t._v("歌手："),t._l(t.details.artists,(function(e,n){return s("router-link",{key:e.name,staticClass:"song_name",attrs:{to:{path:"/singer",query:{id:e.id}}}},[t._v(t._s(0!==n?" / "+e.name:e.name))])}))],2),s("div",{staticClass:"album-time"},[t._v("发行时间："+t._s(t.$utils.formartDate(t.details.publishTime,"yyyy-MM-dd")))]),s("div",{staticClass:"album-company"},[t._v("发行公司："+t._s(t.details.company))]),t.details.description?s("div",{staticClass:"album-desc"},[s("h5",[t._v("歌单简介"),t.isShowDesc?s("em",{staticClass:"desc-close",on:{click:function(e){t.isShowDesc=!1}}},[s("i",{staticClass:"iconfont icon-closed"})]):t._e()]),s("p",{on:{click:t.showAllDesc}},[t._v(t._s(t.details.description))]),t.isShowDesc?s("pre",{staticClass:"album-desc-all"},[t._v("                        "+t._s(t.details.description)+"\n                    ")]):t._e()]):t._e()])]),s("div",{staticClass:"detail-container"},[s("div",{staticClass:"detail-main"},[s("div",{staticClass:"song-header"},[s("h4",[t._v("包含歌曲列表 "),s("em",[t._v(t._s(t.details.size+"首歌"))])]),s("span",{staticClass:"play-all",on:{click:t.playAllSongs}},[s("i",{staticClass:"iconfont icon-audio-play"}),t._v(" 播放全部")]),s("span",{class:["collect",t.dynamic.isSub?"active":""],on:{click:t.subAlbum}},[s("i",{class:["iconfont","icon-collect"+(t.dynamic.isSub?"-active":"")]}),t._v(" "+t._s(t.dynamic.isSub?"已收藏":"收藏"))])]),s("song-list",{attrs:{songList:t.songList,stripe:!0}}),s("div",{ref:"comment",staticClass:"album-comments"},[s("Comments",{attrs:{type:t.type,id:t.albumId}})],1)],1),s("div",{staticClass:"detail-aside"},[s("h3",{staticClass:"aside-title"},[t._v(t._s(t.details.artists[0].name)+"的其他专辑"),s("router-link",{staticClass:"album-more",attrs:{to:{path:"/singer",query:{id:t.details.artists[0].id,type:"album"}}}},[t._v("全部>>")])],1),s("div",{staticClass:"aside-main aside-album-main"},t._l(t.hotAlbums,(function(e){return s("router-link",{key:e.id,staticClass:"aside-album-item",attrs:{to:{path:"/album",query:{id:e.id}}}},[s("el-image",{attrs:{src:e.picUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])]),s("div",{staticClass:"aside-album-info"},[s("div",{staticClass:"aside-album-name"},[t._v(t._s(e.name))]),s("div",{staticClass:"aside-album-time"},[t._v(" "+t._s(t.$utils.formartDate(t.details.publishTime,"yyyy-MM-dd"))+" ")])])],1)})),1)])])])]):t._e()},a=[],i=s("1da1"),r=s("5530"),o=(s("a4d3"),s("e01a"),s("a9e3"),s("d81d"),s("96cf"),s("2f62")),c=s("eb4d"),m=s("18fd"),l=s("09a4"),u={name:"albumDetail",components:{songList:m["a"],Comments:l["a"]},mounted:function(){this.albumId=this.$route.query.id,this._initialize()},data:function(){return{albumId:"",details:null,songList:[],dynamic:{},hotAlbums:[],comments:[],type:3,isShowDesc:!1}},computed:{},methods:Object(r["a"])(Object(r["a"])({},Object(o["d"])({setPlayStatus:"SET_PLAYSTATUS",setPlayList:"SET_PLAYLIST",setPlayIndex:"SET_PLAYINDEX"})),{},{getAlbum:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var n,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.$http.album(t);case 2:if(n=s.sent,a=n.data,200===a.code){s.next=6;break}return s.abrupt("return",e.$msg.error("数据请求失败"));case 6:e.details=a.album,e.songList=e._formatSongs(a.songs),e.getArtistAlbum();case 9:case"end":return s.stop()}}),s)})))()},getAlbumDynamic:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var n,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.$http.albumDynamic(t);case 2:if(n=s.sent,a=n.data,200===a.code){s.next=6;break}return s.abrupt("return",e.$msg.error("数据请求失败"));case 6:e.dynamic=a;case 7:case"end":return s.stop()}}),s)})))()},getArtistAlbum:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.artistAlbum({id:t.details.artists[0].id,limit:5});case 2:if(s=e.sent,n=s.data,200===n.code){e.next=6;break}return e.abrupt("return",t.$msg.error("数据请求失败"));case 6:t.hotAlbums=n.hotAlbums;case 7:case"end":return e.stop()}}),e)})))()},showAllDesc:function(){this.details.description.length>120&&(this.isShowDesc=!this.isShowDesc)},playAllSongs:function(){this.playAll({list:this.songList})},subAlbum:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.albumSub({id:t.albumId,t:Number(!t.dynamic.isSub)});case 2:if(s=e.sent,n=s.data,200===n.code){e.next=6;break}return e.abrupt("return",t.$msg.error("数据请求失败"));case 6:t.dynamic.isSub=Number(!t.dynamic.isSub);case 7:case"end":return e.stop()}}),e)})))()},_formatSongs:function(t){var e=[];return t.map((function(s,n){s.id&&(s.license=!t[n].privilege.cp,e.push(Object(c["a"])(s)))})),e},_initialize:function(){this.getAlbum({id:this.albumId}),this.getAlbumDynamic({id:this.albumId})}},Object(o["b"])(["playAll"])),watch:{$route:function(t,e){this.albumId=this.$route.query.id,this.albumId&&this._initialize()}}},d=u,p=(s("37c1"),s("2877")),h=Object(p["a"])(d,n,a,!1,null,"42950eca",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-113cffb7.432a9712.js.map