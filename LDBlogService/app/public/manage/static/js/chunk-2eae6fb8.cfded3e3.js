(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2eae6fb8"],{"14bb":function(e,t,r){"use strict";r("82e8")},"1cef":function(e,t,r){"use strict";r("5a90")},"4c85":function(e,t,r){"use strict";r("cf43")},"5a90":function(e,t,r){},"5c1d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"createArticle"},[r("div",[r("el-form",{ref:"articleModel",attrs:{model:e.articleModel,rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"文章标题",prop:"articleTitle"}},[r("el-input",{attrs:{clearable:""},model:{value:e.articleModel.articleTitle,callback:function(t){e.$set(e.articleModel,"articleTitle",t)},expression:"articleModel.articleTitle"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"文章分类",prop:"articleCate"}},[r("el-select",{attrs:{placeholder:"请选择文章分类"},model:{value:e.articleModel.articleCate,callback:function(t){e.$set(e.articleModel,"articleCate",t)},expression:"articleModel.articleCate"}},[r("el-option",{attrs:{label:"前端技术",value:"1"}}),r("el-option",{attrs:{label:"后端技术",value:"2"}}),r("el-option",{attrs:{label:"生活随笔",value:"3"}})],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"文章简介",prop:"articleDesc"}},[r("el-input",{attrs:{clearable:"",rows:2,type:"textarea"},model:{value:e.articleModel.articleDesc,callback:function(t){e.$set(e.articleModel,"articleDesc",t)},expression:"articleModel.articleDesc"}})],1),r("el-form-item",{staticClass:"tagSelect",attrs:{label:"标签分类",prop:"articleTags"}},[r("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.articleModel.articleTags,callback:function(t){e.$set(e.articleModel,"articleTags",t)},expression:"articleModel.articleTags"}},e._l(e.articleTagsSelect,(function(e){return r("el-option",{key:e._id,attrs:{label:e.articleTagName,value:e.articleTagName}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("div",{staticStyle:{display:"flex","align-items":"flex-start"}},[r("el-form-item",{directives:[{name:"permission",rawName:"v-permission",value:{role:"admin",type:"btn"},expression:"{role:'admin',type:'btn'}"}],staticStyle:{width:"60%"},attrs:{label:"文章图片",prop:"coverImg"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadImgUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.articleModel.coverImg?r("img",{staticClass:"avatar",attrs:{src:e.articleModel.coverImg}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("div",{staticClass:"btns"},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:{role:"admin",type:"btn"},expression:"{role:'admin',type:'btn'}"}],staticStyle:{height:"40px"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("articleModel")}}},[e._v("发布文章")]),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:{role:"admin",type:"btn"},expression:"{role:'admin',type:'btn'}"}],staticStyle:{height:"40px",margin:"2px 0"},attrs:{type:"primary"},on:{click:function(t){return e.resetForm("articleModel")}}},[e._v("重置文章")]),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:{role:"admin",type:"btn"},expression:"{role:'admin',type:'btn'}"}],staticStyle:{height:"40px","margin-left":"0"},attrs:{type:"primary"},on:{click:function(t){return e.saveDraft("articleModel")}}},[e._v("保存草稿")])],1)],1)])],1)],1)],1),r("div",{staticClass:"editor"},[r("div",{ref:"editorRef",staticClass:"editorDom"})])])},i=[],n=r("15fd"),c=r("5530"),l=r("1da1"),s=(r("4de4"),r("d3b7"),r("96cf"),r("6fad")),o=r.n(s),u=(r("6e2e"),r("1487")),d=r.n(u),m=["_id"],p={data:function(){return{articleModel:{coverImg:"",articleCate:""},rules:{articleTitle:[{required:!0,message:"请选择文章标题",trigger:"blur"},{min:5,max:30,message:"长度在 5 到 30 个字符",trigger:"blur"}],articleCate:[{required:!0,message:"请选择文章分类",trigger:"blur"}],articleDesc:[{required:!0,message:"请填写文章简介",trigger:"blur"},{min:5,max:40,message:"长度在 5 到 80 个字符",trigger:"blur"}],coverImg:[{required:!0,message:"请上传文章封面",trigger:"blur"}]},editor:null,imageUrl:"",uploadImgUrl:"http://andy.lmytest.top/uploadImg",articleTagsSelect:["Vue","React","nodejs","java","数据库","部署"]}},watch:{"articleModel.articleCate":function(e,t){this.handleGetTags(e)}},mounted:function(){this.initEditor(),this.getDraft()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}t.$confirm("是否发布文章?","提示",{callback:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(r){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==r){e.next=6;break}return a=t.editor.txt.html(),e.next=4,t.$http({url:"/article/createArtice",data:Object(c["a"])(Object(c["a"])({},t.articleModel),{},{content:a}),method:"post"});case 4:i=e.sent,i&&i.success&&(t.$message.success("发布成功"),t.$router.push({name:"articleList"}));case 6:case"end":return e.stop()}}),e)})));function r(t){return e.apply(this,arguments)}return r}()}),e.next=6;break;case 4:return console.log("error submit!!"),e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){var t=this;this.$confirm("是否重置文章信息?","提示",{callback:function(){var r=Object(l["a"])(regeneratorRuntime.mark((function r(a){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:"confirm"===a&&(t.$refs[e].resetFields(),t.articleModel={});case 1:case"end":return r.stop()}}),r)})));function a(e){return r.apply(this,arguments)}return a}()})},saveDraft:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$confirm("是否保存草稿?","提示",{callback:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(r){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==r){e.next=6;break}return a=t.editor.txt.html(),e.next=4,t.$http({url:"/article/saveDraft",method:"post",data:Object(c["a"])(Object(c["a"])({},t.articleModel),{},{content:a})});case 4:i=e.sent,i&&i.success&&t.$message.success("保存成功");case 6:case"end":return e.stop()}}),e)})));function r(t){return e.apply(this,arguments)}return r}()});case 1:case"end":return e.stop()}}),e)})))()},getDraft:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http({url:"/article/getDraft",method:"get"});case 2:r=t.sent,r&&r.success&&(a=r.data?r.data[0]:{},a._id,i=Object(n["a"])(a,m),e.articleModel=i,e.$nextTick((function(){e.editor.txt.html(e.articleModel.content)})));case 4:case"end":return t.stop()}}),t)})))()},initEditor:function(){var e=this,t=new o.a(this.$refs.editorRef);t.config.height=1e3,t.config.zIndex=10,t.highlight=d.a,t.config.customUploadImg=function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(r,a){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new FormData,i.append("file",r[0]),t.next=4,e.$http({url:"/uploadImg",data:i,method:"post"});case 4:n=t.sent,n.success?a(n.data):e.$message.error(n.data);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),t.create(),this.editor=t},handleAvatarSuccess:function(e){e&&e.success&&(this.articleModel.coverImg=e.data)},beforeAvatarUpload:function(e){console.log("file",e)},handleGetTags:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var a,i,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http({url:"/articleTag/getTags",method:"get"});case 2:a=r.sent,a&&a.success?(i=a.data||[],n=i.filter((function(t){return t.articleCateId==e})),t.articleTagsSelect=n):t.$message.error(a.error);case 4:case"end":return r.stop()}}),r)})))()}}},f=p,g=(r("14bb"),r("4c85"),r("1cef"),r("2877")),h=Object(g["a"])(f,a,i,!1,null,"364dec04",null);t["default"]=h.exports},"82e8":function(e,t,r){},cf43:function(e,t,r){}}]);