(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c590a8ac"],{"1e64":function(t,e,s){"use strict";s("7860")},6819:function(t,e,s){"use strict";s("a679")},7860:function(t,e,s){},"93a3":function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"reply-comment"},[s("h3",[t._v("我回复@"+t._s(t.params.user.nickname)+":")]),s("div",{staticClass:"comment_textarea"},[s("div",{staticClass:"pre"},[t._v(t._s(t.msg))]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],staticClass:"J_inpBox inp-paragraph",attrs:{name:"leave_msg",id:"leave_msg",placeholder:"期待你的神评论……"},domProps:{value:t.msg},on:{input:function(e){e.target.composing||(t.msg=e.target.value)}}})]),s("div",{staticClass:"comment_box_footer"},[s("span",{staticClass:"comment_limit"},[s("em",{staticClass:"num"},[t._v(t._s(t.msg.length))]),t._v("/"+t._s(t.maxLen))]),s("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.subReplyComment}},[t._v("评论")])],1)])},i=[],a={name:"replyComment",components:{},props:["params"],data:function(){return{msg:"",maxLen:140}},computed:{},methods:{subReplyComment:function(){this.$emit("replyMsg",this.msg)}},watch:{msg:function(){this.msg=this.maxLen>=this.msg?this.msg:this.msg.substring(0,this.maxLen)}}},o=a,r=(s("6819"),s("2877")),m=Object(r["a"])(o,n,i,!1,null,"6a6b203a",null);e["a"]=m.exports},a679:function(t,e,s){},a7e0:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comments"},[s("div",{staticClass:"comment_hd"},[s("h2",[t._v("反馈"),s("em",[t._v("共"+t._s(t.total)+"条反馈")])]),t.userInfo?s("div",{staticClass:"userInfo"},[s("span",[t._v(t._s(t.userInfo.nickname))]),s("el-image",{staticClass:"avatar",attrs:{src:t.userInfo.avatarUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1):t._e()]),s("el-form",{staticClass:"comment_box"},[s("div",{staticClass:"comment_textarea"},[s("div",{staticClass:"pre"},[t._v(t._s(t.msg))]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],staticClass:"J_inpBox inp-paragraph",attrs:{name:"leave_msg",id:"leave_msg",placeholder:"期待你的神评论……"},domProps:{value:t.msg},on:{input:function(e){e.target.composing||(t.msg=e.target.value)}}})]),s("div",{staticClass:"comment_box_footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.subComment}},[t._v("反馈")]),s("span",{staticClass:"comment_limit"},[s("em",{staticClass:"num"},[t._v(t._s(t.msg.length))]),t._v("/"+t._s(t.maxLen))])],1)]),s("div",{staticClass:"comment_area"},[t.comments.length?[t._l(t.comments,(function(e,n){return s("div",{key:e.commentId+n+"",staticClass:"comment_item"},[s("router-link",{staticClass:"comment_avatar",attrs:{to:{path:"/user",query:{id:e.user.userId}}}},[s("el-image",{attrs:{src:e.user.avatarUrl+"?param=120y120"}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1),s("div",{staticClass:"comment_info"},[s("router-link",{attrs:{to:{path:"/user",query:{id:e.user.userId}}}},[t._v(t._s(e.user.nickname))]),s("div",{staticClass:"comment_content"},[t._v(" "+t._s(e.content)+" ")]),t._l(e.beReplied,(function(e){return s("div",{key:e.beRepliedCommentId,staticClass:"comment_reply"},[s("router-link",{attrs:{to:{path:"/user",query:{id:e.user.userId}}}},[t._v(t._s(e.user.nickname))]),t._v(": "+t._s(e.content)+" ")],1)})),s("div",{staticClass:"comment_footer"},[s("div",{staticClass:"comment_time"},[t._v(t._s(t.$utils.formatMsgTime(e.time)))]),s("div",{staticClass:"comment_oper"},[t.userInfo&&t.userInfo.userId===e.user.userId?s("em",{staticClass:"comment_del",on:{click:function(s){return t.delComment(e)}}},[s("i",{staticClass:"iconfont icon-del"})]):t._e(),s("span",{class:[e.liked?"active":""],on:{click:function(s){return t.likeComment(e)}}},[s("i",{staticClass:"iconfont icon-praise"}),t._v("("+t._s(e.likedCount)+")")]),s("span",{staticClass:"replyComment",on:{click:function(s){return t.replyComment(e,n)}}},[s("i",{staticClass:"iconfont icon-comment"})])])]),e.isHot?s("div",{staticClass:"isHot"},[s("i",{staticClass:"iconfont icon-choicest"})]):t._e(),s("transition",{attrs:{name:"fade",mode:"out-in"}},[t.isShowReply(e,n)?s("replyComment",{attrs:{params:e},on:{replyMsg:t.replyMsg}}):t._e()],1)],2)],1)})),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:this.total},on:{"current-change":t.currentChange}})],1)]:s("div",{staticClass:"comments_status"},[t.isEmpty?s("div",{staticClass:"empty"},[t._m(0),s("p",[t._v("暂无反馈")])]):s("div",{staticClass:"loading"},[t._v("评论加载中...")])])],2)],1)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("i",{staticClass:"iconfont icon-empty-main"})])}],a=s("2909"),o=s("1da1"),r=s("5530"),m=(s("d81d"),s("99af"),s("a9e3"),s("96cf"),s("2f62")),c=s("93a3"),l={name:"Comments",components:{replyComment:c["a"]},data:function(){return{msg:"",maxLen:140,curId:this.id,limit:20,offset:0,before:0,hotComments:[],comments:[],total:0,currentPage:0,isEmpty:!1,replyCommentId:0,replyIndex:-1,type:2,id:"986847103"}},computed:Object(r["a"])(Object(r["a"])({},Object(m["c"])(["isLogin","userInfo"])),{},{isShowReply:function(){return function(t,e){return t.commentId===this.replyCommentId&&this.replyIndex===e}}}),mounted:function(){this.getComment()},methods:Object(r["a"])(Object(r["a"])({},Object(m["d"])(["setLoginDialog"])),{},{getComment:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.playlistComment({id:t.id,limit:t.limit,offset:t.offset,before:t.before});case 2:s=e.sent,n=s.data,t.msgHandler(n);case 5:case"end":return e.stop()}}),e)})))()},msgHandler:function(t){if(200!==t.code)return this.$msg.error("数据请求失败");this.total=t.total,this.hotComments=t.hotComments||[],this.hotComments.map((function(t){return t.isHot=!0,t})),this.comments=[].concat(Object(a["a"])(this.hotComments),Object(a["a"])(t.comments)),this.isEmpty=0===this.before&&!this.comments.length},commentHandler:function(t,e,s){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var a,o,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a={t:t,type:n.type,id:n.curId,content:e,commentId:s},i.next=3,n.$http.comment(a);case 3:if(o=i.sent,r=o.data,200===r.code){i.next=7;break}return i.abrupt("return",n.$msg.error("数据请求失败"));case 7:n.msg="",n.getComment(),0===t?n.$msg.success("删除评论成功！"):1===t?n.$msg.success("评论成功！"):2===t&&(n.$msg.success("回复评论成功！"),n.replyCommentId=0,n.replyIndex=-1);case 10:case"end":return i.stop()}}),i)})))()},subComment:function(){this.isLogin?this.commentHandler(1,this.msg):this.setLoginDialog(!0)},delComment:function(t){var e=this;this.$msgBox.confirm("确定删除评论？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){e.commentHandler(0,"",t.commentId)})).catch((function(){}))},replyComment:function(t,e){this.isLogin?(this.replyCommentId=this.replyCommentId===t.commentId&&this.replyIndex===e?0:t.commentId,this.replyIndex=e):this.setLoginDialog(!0)},replyMsg:function(t){this.isLogin?this.commentHandler(2,t,this.replyCommentId):this.setLoginDialog(!0)},likeComment:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var n,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(e.isLogin){s.next=3;break}return e.setLoginDialog(!0),s.abrupt("return");case 3:return s.next=5,e.$http.commentLike({id:e.curId,cid:t.commentId,t:Number(!t.liked),type:e.type});case 5:if(n=s.sent,i=n.data,200===i.code){s.next=9;break}return s.abrupt("return",e.$msg.error("数据请求失败"));case 9:e.getComment();case 10:case"end":return s.stop()}}),s)})))()},currentChange:function(t){this.offset=(t-1)*this.limit,this.getComment()}}),watch:{id:function(t,e){this.curId=t,this.offset=0,this.getComment()},msg:function(){this.msg=this.maxLen>=this.msg?this.msg:this.msg.substring(0,this.maxLen)}}},u=l,d=(s("1e64"),s("2877")),p=Object(d["a"])(u,n,i,!1,null,"6568eb90",null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-c590a8ac.94d4c80f.js.map